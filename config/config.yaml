# OrbyGlasses Config - Simple Settings

# Camera Settings
camera:
  source: 0       # 0 = webcam, or URL for IP camera
  width: 640      # Resolution width
  height: 480     # Resolution height
  fps: 30         # Frames per second

# BREAKTHROUGH AI MODELS - Industry-Leading 2025 Technology
models:
  # Object Detection - YOLOv11n (SOTA 2024)
  yolo:
    path: "models/yolo/yolo11n.pt"
    confidence: 0.45  # Optimized for blind navigation
    iou_threshold: 0.45
    device: "mps"
    half_precision: true

  # Depth Estimation - Depth Anything V2 Small (SOTA 2024)
  # Research: Best accuracy/speed tradeoff (0.22s, MAE 0.454m)
  # Beats MiDaS 3.1, ZoeDepth, outperforms all competitors
  depth:
    path: "depth-anything/Depth-Anything-V2-Small-hf"
    device: "mps"
    half_precision: true
    max_resolution: 518  # Optimal resolution for SHARP metric depth

  # Vision-Language Model - Moondream2 (Fast 2B param VLM)
  # Provides scene understanding + navigation guidance
  llm:
    primary: "gemma3:4b"
    vision: "moondream"  # Moondream2: 1.86B params, <3s inference
    temperature: 0.6
    max_tokens: 100
    vlm_enabled: true  # BREAKTHROUGH: Real-time scene understanding
    scene_analysis_interval: 15  # Smart scene analysis

# Voice Commands (Optional)
conversation:
  enabled: false  # Turn on for voice control
  model: "gemma3:4b"
  temperature: 0.7
  max_tokens: 200
  voice_input: true
  activation_phrase: "hey orby"
  check_interval: 1.0
  simple_commands: true
  command_phrases:
    - "what's around me"
    - "is the path clear"
    - "where am I"

# Social Navigation (Optional)
social_navigation:
  enabled: true
  region: "us"  # 'us', 'uk', 'japan', etc.
  voice_announce: true

# BREAKTHROUGH Audio - Multi-modal Sensory Feedback
audio:
  tts_engine: "pyttsx3"
  tts_rate: 190  # Optimized for clarity + speed
  tts_volume: 1.0  # Full volume
  echolocation_enabled: true  # Biomimetic audio cues
  spatial_audio: true  # 3D positional audio
  adaptive_beaconing_enabled: true  # Dynamic audio beacons
  beacon_safe_frequency: 440  # Clear path tone
  beacon_obstacle_frequency: 880  # Obstacle warning tone
  warning_pulse_rate: 0.12  # Rapid warnings for urgent hazards
  door_beacon: 660  # Door detection
  stairs_beacon: 1320  # Stair warning
  clear_path_beacon: 330  # Safe navigation tone

# Echolocation
echolocation:
  room_dimensions: [10, 10, 3]  # meters
  sample_rate: 16000
  duration: 0.1

# RL Prediction (Optional)
prediction:
  enabled: false
  model_path: "models/rl/ppo_navigation.zip"
  training_steps: 10000
  save_interval: 1000

# Safety
safety:
  min_safe_distance: 1.5  # meters
  danger_distance: 1.0    # meters
  caution_distance: 2.5   # meters
  emergency_stop_key: "q"
  max_obstacle_alerts: 3

# Logging
logging:
  level: "WARNING"  # WARNING, INFO, or DEBUG
  log_file: "data/logs/orbyglass.log"
  save_detections: true
  save_frames: false

# BREAKTHROUGH Performance - Real-time Multi-sensor Fusion
performance:
  audio_update_interval: 1.2  # Fast, responsive feedback
  danger_audio_interval: 0.25  # CRITICAL: Instant danger alerts
  stats_interval: 200
  max_detections: 8  # Comprehensive obstacle detection
  depth_skip_frames: 1  # Every 2nd frame (high-quality depth)
  frame_skip: 0
  enable_multithreading: true  # Parallel AI processing
  cache_depth_maps: true

# 3D Mapping - DISABLED
mapping3d:
  enabled: false  # Not needed for navigation
  max_depth: 6.0
  voxel_size: 0.15
  subsample_step: 8
  update_interval: 0.3
  fx: 500
  fy: 500
  skip_bbox: true

# BREAKTHROUGH: Highly Accurate Real-time SLAM
slam:
  enabled: true  # Optimized for accuracy
  grid_size: [400, 400]  # Larger grid for better mapping
  grid_resolution: 0.1  # Finer resolution (was 0.2)
  save_maps: true
  visualize: true  # Show SLAM in separate window
  orb_features: 2000  # More features for better tracking (was 1000)
  fast_threshold: 15  # Lower for more features (was 20)
  min_matches: 25  # Higher for better accuracy (was 15)
  motion_model: true
  pose_smoothing: 0.85  # Higher smoothing for accuracy (was 0.7)
  temporal_consistency_check: true
  max_position_jump: 0.15  # Tighter constraint (was 0.3)
  max_rotation_jump: 0.15  # Tighter constraint (was 0.3)
  min_tracked_features: 30  # Higher minimum (was 20)
  keyframe_threshold: 30  # More selective keyframes (was 20)
  reprojection_threshold: 2.0  # Stricter (was 3.0)
  min_depth: 0.1
  max_depth: 10.0
  loop_closure: true  # Enable for accuracy
  bundle_adjustment: true  # Enable for refinement

# BREAKTHROUGH: PathFinder-style Obstacle-Free Navigation
indoor_navigation:
  enabled: true  # DFS path planning for longest obstacle-free route
  path_planning: true
  save_locations: true

# Trajectory Prediction - DISABLED
trajectory_prediction:
  enabled: false  # Too complex
  max_history: 10
  prediction_horizon: 3
  time_step: 0.5
  visualize: false
  collision_warning: true

# 3D Occupancy Grid - DISABLED
occupancy_grid_3d:
  enabled: false  # Not needed
  grid_size: [10.0, 10.0, 3.0]
  resolution: 0.1
  max_range: 5.0
  visualize: false

# Point Cloud - DISABLED
point_cloud_viewer:
  enabled: false  # Visual feature, not for blind users
  max_points: 100000
  subsample: 3
  min_depth: 0.1
  max_depth: 5.0

# Movement Visualizer - DISABLED
movement_visualizer:
  enabled: false  # Visual feature, not needed
  canvas_size: [700, 700]
  trail_length: 200
  show_stats: true
